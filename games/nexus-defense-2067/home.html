<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NEXUS DEFENSE 2067 - Home</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      background: linear-gradient(135deg, #0f172a, #1e293b, #334155);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: 'Arial', sans-serif;
      color: #fff;
      overflow: hidden;
    }
    
    /* Animated background */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 50%, rgba(239, 68, 68, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(250, 204, 21, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 40% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%);
      animation: pulse 10s ease-in-out infinite;
      z-index: 0;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 1; }
    }
    
    .container {
      position: relative;
      z-index: 1;
      text-align: center;
      max-width: 1200px;
      padding: 40px;
    }
    
    h1 {
      font-size: 4em;
      font-weight: 900;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 5px;
      background: linear-gradient(135deg, #facc15, #ef4444, #facc15);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 0 30px rgba(250, 204, 21, 0.5);
      animation: glow 2s ease-in-out infinite;
    }
    
    @keyframes glow {
      0%, 100% { filter: brightness(1); }
      50% { filter: brightness(1.3); }
    }
    
    .subtitle {
      font-size: 1.5em;
      color: #94a3b8;
      margin-bottom: 50px;
      letter-spacing: 2px;
    }
    
    .menu {
      display: flex;
      gap: 30px;
      justify-content: center;
      margin-bottom: 50px;
    }
    
    .menu-btn {
      background: linear-gradient(135deg, #1e293b, #334155);
      border: 3px solid #facc15;
      color: #facc15;
      padding: 20px 50px;
      font-size: 1.5em;
      font-weight: bold;
      border-radius: 15px;
      cursor: pointer;
      transition: all 0.3s;
      text-transform: uppercase;
      letter-spacing: 2px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }
    
    .menu-btn:hover {
      background: linear-gradient(135deg, #facc15, #f59e0b);
      color: #000;
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(250, 204, 21, 0.4);
    }
    
    .deck-section {
      background: rgba(30, 41, 59, 0.8);
      border: 2px solid #facc15;
      border-radius: 20px;
      padding: 30px;
      margin-top: 30px;
      backdrop-filter: blur(10px);
    }
    
    .deck-title {
      font-size: 2em;
      color: #facc15;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 3px;
    }
    
    .deck-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .deck-card {
      background: rgba(51, 65, 85, 0.8);
      border: 2px solid #475569;
      border-radius: 12px;
      padding: 15px;
      text-align: center;
      transition: all 0.3s;
      cursor: pointer;
    }
    
    .deck-card:hover {
      border-color: #facc15;
      transform: scale(1.05);
      box-shadow: 0 8px 20px rgba(250, 204, 21, 0.3);
    }
    
    .deck-card.selected {
      border-color: #22c55e;
      background: rgba(34, 197, 94, 0.2);
      box-shadow: 0 0 20px rgba(34, 197, 94, 0.5);
    }
    
    .deck-card.locked {
      opacity: 0.4;
      cursor: not-allowed;
    }
    
    .card-icon {
      font-size: 3em;
      margin-bottom: 10px;
    }
    
    .card-name {
      font-size: 0.9em;
      font-weight: bold;
      color: #fff;
      margin-bottom: 5px;
    }
    
    .card-desc {
      font-size: 0.75em;
      color: #94a3b8;
    }
    
    .card-cost {
      font-size: 0.85em;
      color: #facc15;
      font-weight: bold;
      margin-top: 5px;
    }
    
    .tabs {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 20px;
    }
    
    .tab-btn {
      background: rgba(51, 65, 85, 0.5);
      border: 2px solid #475569;
      color: #94a3b8;
      padding: 10px 30px;
      font-size: 1em;
      font-weight: bold;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s;
      text-transform: uppercase;
    }
    
    .tab-btn.active {
      background: #facc15;
      color: #000;
      border-color: #facc15;
    }
    
    .save-deck-btn {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      border: none;
      color: #fff;
      padding: 15px 40px;
      font-size: 1.2em;
      font-weight: bold;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s;
      text-transform: uppercase;
      margin-top: 20px;
    }
    
    .deck-info {
      color: #94a3b8;
      margin-top: 15px;
      font-size: 0.9em;
    }
    
    /* Tutorial Modal */
    .tutorial-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.95);
      z-index: 1000;
      overflow-y: auto;
      padding: 20px;
    }
    
    .tutorial-content {
      max-width: 900px;
      margin: 20px auto;
      background: linear-gradient(135deg, #1e293b, #0f172a);
      border: 3px solid #facc15;
      border-radius: 20px;
      padding: 40px;
      color: #fff;
    }
    
    .tutorial-content h2 {
      color: #facc15;
      text-align: center;
      margin-bottom: 30px;
      font-size: 2.5em;
      text-shadow: 0 0 20px rgba(250, 204, 21, 0.5);
    }
    
    .tutorial-section {
      margin-bottom: 25px;
      padding: 20px;
      background: rgba(51, 65, 85, 0.5);
      border-radius: 10px;
      border-left: 4px solid #facc15;
    }
    
    .tutorial-section h3 {
      color: #facc15;
      margin-bottom: 15px;
      font-size: 1.5em;
    }
    
    .tutorial-section p, .tutorial-section li {
      line-height: 1.8;
      margin-bottom: 10px;
      color: #cbd5e1;
    }
    
    .tutorial-section ul {
      margin-left: 20px;
      margin-top: 10px;
    }
    
    .close-tutorial {
      background: linear-gradient(135deg, #facc15, #f59e0b);
      border: none;
      color: #000;
      padding: 15px 50px;
      font-size: 1.2em;
      border-radius: 10px;
      cursor: pointer;
      display: block;
      margin: 30px auto 0;
      font-weight: bold;
      transition: all 0.3s;
    }
    
    .close-tutorial:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 30px rgba(250, 204, 21, 0.6);
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>‚ö° NEXUS DEFENSE 2067</h1>
    <p class="subtitle">Defend the Last Stronghold</p>
    
    <div class="menu">
      <button class="menu-btn" onclick="startGame()">üéÆ Start Game</button>
      <button class="menu-btn" onclick="toggleDeckEditor()">üìã Edit Deck</button>
      <button class="menu-btn" onclick="showTutorial()">üìñ Tutorial</button>
      <button class="menu-btn" onclick="goToGameCentre()">üè† Back to Games</button>
    </div>
    
    <div class="deck-section" id="deckEditor" style="display: none;">
      <div class="deck-title">‚öîÔ∏è Deck Editor</div>
      <p class="deck-info">Select items to add to your battle deck (Max 8 items)</p>
      
      <div class="tabs">
        <button class="tab-btn active" onclick="showTab('towers')">Towers</button>
        <button class="tab-btn" onclick="showTab('spells')">Spells</button>
        <button class="tab-btn" onclick="showTab('soldiers')">Soldiers</button>
      </div>
      
      <div id="deckGrid" class="deck-grid"></div>
      
      <button class="save-deck-btn" onclick="saveDeck()">üíæ Save Deck & Start</button>
    </div>
  </div>
  
  <!-- Tutorial Modal -->
  <div class="tutorial-modal" id="tutorialModal">
    <div class="tutorial-content">
      <h2>üìñ NEXUS DEFENSE 2067 - Tutorial</h2>
      
      <div class="tutorial-section">
        <h3>üéØ Objective</h3>
        <p>Defend your base from waves of enemies! Prevent them from reaching the end of the path. You lose 1 life per enemy that escapes. Survive all waves to complete the level!</p>
      </div>
      
      <div class="tutorial-section">
        <h3>üè∞ Towers</h3>
        <p>Place towers along the path to attack enemies automatically:</p>
        <ul>
          <li><strong>Machine Gun (üî´):</strong> Fast firing, moderate damage</li>
          <li><strong>Laser Tower (‚ö°):</strong> High damage, long range</li>
          <li><strong>Sniper Tower (üéØ):</strong> Extreme range, high damage</li>
          <li><strong>Cannon (üí•):</strong> Area damage, slow firing</li>
        </ul>
        <p><strong>Tip:</strong> Click a tower in your deck, then click on the map to place it. Can't place on paths!</p>
      </div>
      
      <div class="tutorial-section">
        <h3>‚ú® Spells</h3>
        <p>Cast powerful spells during waves:</p>
        <ul>
          <li><strong>Bomb (üí£):</strong> 200 area damage</li>
          <li><strong>Nuke (‚ò¢Ô∏è):</strong> MASSIVE area damage over 3 seconds!</li>
          <li><strong>EMP (‚ö°):</strong> Stuns enemies for 3 seconds</li>
          <li><strong>Airstrike (‚úàÔ∏è):</strong> Vertical line damage</li>
        </ul>
        <p><strong>Tip:</strong> Spells have cooldowns. Use them wisely!</p>
      </div>
      
      <div class="tutorial-section">
        <h3>üëÆ Soldiers</h3>
        <p>Deploy soldier teams to fight enemies:</p>
        <ul>
          <li><strong>Police Team (üëÆ):</strong> 3 units, balanced stats</li>
          <li><strong>SWAT Team (üöî):</strong> 4 units, faster and stronger</li>
          <li><strong>Military (üéñÔ∏è):</strong> 5 elite soldiers</li>
          <li><strong>Cyborg Squad (ü§ñ):</strong> 2 powerful units</li>
        </ul>
        <p><strong>NEW! Soldier Control:</strong></p>
        <ul>
          <li><strong>Left-click</strong> on a soldier to select the team</li>
          <li><strong>Right-click</strong> on the map to move selected soldiers</li>
          <li>Works during prep time AND during waves!</li>
        </ul>
      </div>
      
      <div class="tutorial-section">
        <h3>üí∞ Economy</h3>
        <p>Earn gold by killing enemies. Use gold to:</p>
        <ul>
          <li>Place towers (costs gold)</li>
          <li>Buy new items in the store</li>
          <li>Build your deck (max 6 items)</li>
        </ul>
        <p><strong>Tip:</strong> You can remove items from your deck in the store to get a full refund!</p>
      </div>
      
      <div class="tutorial-section">
        <h3>üéÆ Controls</h3>
        <ul>
          <li><strong>Left-click:</strong> Place tower, cast spell, deploy soldiers, or select soldier team</li>
          <li><strong>Right-click:</strong> Move selected soldiers</li>
          <li><strong>Start Wave:</strong> Begin the enemy assault</li>
          <li><strong>Next Level:</strong> Advance after completing a wave</li>
        </ul>
      </div>
      
      <div class="tutorial-section">
        <h3>üìä Progression</h3>
        <p>Each level has unique maps with dual paths. Maps get more complex as you progress!</p>
        <ul>
          <li><strong>Levels 1-4:</strong> Learning phase</li>
          <li><strong>Levels 5-7:</strong> Advanced challenges</li>
          <li><strong>Level 8+:</strong> Ultimate difficulty!</li>
        </ul>
      </div>
      
      <button class="close-tutorial" onclick="closeTutorial()">‚úÖ Got It!</button>
    </div>
  </div>
  
  <script>
    let currentTab = 'towers';
    let selectedDeck = [];
    let ownedItems = {
      towers: ['machineGun'],
      spells: ['bomb'],
      soldiers: ['policeTeam']
    };
    
    // Load saved data
    const savedData = localStorage.getItem('towerDefenseSave');
    if (savedData) {
      try {
        const data = JSON.parse(savedData);
        if (data.ownedItems) ownedItems = data.ownedItems;
        if (data.playerDeck) selectedDeck = data.playerDeck.map(item => item.id);
      } catch(e) {}
    }
    
    const allItems = {
      towers: [
        { id: 'machineGun', name: 'Machine Gun', icon: 'üî´', desc: '3x5 DMG, 120 range', owned: true },
        { id: 'sniper', name: 'Sniper Rifle', icon: 'üéØ', desc: '80 DMG, 250 range' },
        { id: 'laser', name: 'Laser Turret', icon: '‚ö°', desc: '15 DMG, rapid fire' },
        { id: 'rocket', name: 'Rocket Launcher', icon: 'üöÄ', desc: '50 DMG, splash' },
        { id: 'plasma', name: 'Plasma Cannon', icon: 'üí†', desc: '100 DMG, energy' }
      ],
      spells: [
        { id: 'bomb', name: 'Bomb', icon: 'üí£', desc: '200 area damage', owned: true },
        { id: 'airstrike', name: 'Airstrike', icon: '‚úàÔ∏è', desc: 'Line damage' },
        { id: 'emp', name: 'EMP Blast', icon: '‚ö°', desc: 'Stuns enemies' },
        { id: 'nuke', name: 'Tactical Nuke', icon: '‚ò¢Ô∏è', desc: 'Huge devastation' },
        { id: 'heal', name: 'Repair Kit', icon: 'üîß', desc: 'Restore 5 lives' },
        { id: 'goldRush', name: 'Supply Drop', icon: 'üì¶', desc: 'Gain 300 gold' }
      ],
      soldiers: [
        { id: 'policeTeam', name: 'Police Team', icon: 'üëÆ', desc: '3 units, 80HP, 18 DMG', owned: true },
        { id: 'swatTeam', name: 'SWAT Team', icon: 'üöî', desc: '4 units, 120HP, 25 DMG' },
        { id: 'military', name: 'Military Squad', icon: 'üéñÔ∏è', desc: '5 units, 160HP, 35 DMG' },
        { id: 'cyborg', name: 'Cyborg Unit', icon: 'ü§ñ', desc: '2 units, 250HP, 55 DMG' }
      ]
    };
    
    function toggleDeckEditor() {
      const editor = document.getElementById('deckEditor');
      editor.style.display = editor.style.display === 'none' ? 'block' : 'none';
      if (editor.style.display === 'block') {
        renderDeck();
      }
    }
    
    function showTab(tab) {
      currentTab = tab;
      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      renderDeck();
    }
    
    function renderDeck() {
      const grid = document.getElementById('deckGrid');
      grid.innerHTML = '';
      
      console.log('Rendering tab:', currentTab);
      console.log('Items:', allItems[currentTab]);
      console.log('Owned items:', ownedItems[currentTab]);
      
      if (!allItems[currentTab]) {
        console.error('No items for tab:', currentTab);
        return;
      }
      
      allItems[currentTab].forEach(item => {
        // Check if owned from save data OR if it's a default starter item
        const ownedList = ownedItems[currentTab] || [];
        const isOwned = ownedList.includes(item.id) || item.owned === true;
        const isSelected = selectedDeck.includes(item.id);
        
        const card = document.createElement('div');
        card.className = `deck-card ${isSelected ? 'selected' : ''} ${!isOwned ? 'locked' : ''}`;
        card.innerHTML = `
          <div class="card-icon">${item.icon}</div>
          <div class="card-name">${item.name}</div>
          <div class="card-desc">${item.desc}</div>
          ${!isOwned ? '<div class="card-cost">üîí Locked</div>' : ''}
        `;
        
        if (isOwned) {
          card.onclick = () => toggleSelection(item.id);
        }
        
        grid.appendChild(card);
      });
    }
    
    function toggleSelection(itemId) {
      const index = selectedDeck.indexOf(itemId);
      if (index > -1) {
        selectedDeck.splice(index, 1);
      } else {
        if (selectedDeck.length < 8) {
          selectedDeck.push(itemId);
        } else {
          alert('Maximum 8 items in deck!');
          return;
        }
      }
      renderDeck();
    }
    
    function saveDeck() {
      // Save deck to localStorage
      const deckItems = [];
      selectedDeck.forEach(id => {
        for (let category in allItems) {
          const item = allItems[category].find(i => i.id === id);
          if (item) {
            deckItems.push({
              ...item,
              type: category === 'soldiers' ? 'soldier' : 'spell',
              cooldown: category === 'soldiers' ? 15 : 10
            });
            break;
          }
        }
      });
      
      localStorage.setItem('playerDeck', JSON.stringify(deckItems));
      alert('Deck saved! Starting game...');
      startGame();
    }
    
    function startGame() {
      window.location.href = 'index.html';
    }
    
    function goToGameCentre() {
      window.location.href = '../../games.html';
    }
    
    function showTutorial() {
      document.getElementById('tutorialModal').style.display = 'block';
    }
    
    function closeTutorial() {
      document.getElementById('tutorialModal').style.display = 'none';
    }
  </script>
</body>
</html>
